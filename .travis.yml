dist: trusty
sudo: true
addons:
    apt:
        packages:
            - libcurl4-openssl-dev
            - libelf-dev
            - libdw-dev
            - binutils-dev
            - libiberty-dev
            - g++
language: rust
before_install:
  - cargo install cargo-kcov
install:
    - rustc -vV
    - cargo -vV

    # install kcov
    - mkdir -p ~/.cargo/bin
    - sh src/install_kcov.sh
    - export PATH=$HOME/.local/bin:$HOME/.cargo/bin:$HOME/Library/Python/2.7/bin:$PATH
    - export RUSTFLAGS="-C link-dead-code"
    - kcov --version

rust:
  - nightly
matrix:
  fast_finish: true
cache: cargo
script:
  - cargo build
  - cargo test
  - cargo kcov --coveralls    
